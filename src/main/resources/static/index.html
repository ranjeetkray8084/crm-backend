<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Real Estate CRM - Home</title>
  <link rel="stylesheet" href="assets/css/style.css" />
  <link rel="stylesheet" href="assets/css/comman/footer.css">
  <style>
    .password-wrapper {
      position: relative;
    }

    .password-wrapper input {
      /* width: 86%; */
      padding-right: 40px; /* space for eye button */
    }

    .toggle-password {
      position: absolute;
      top: 50%;
      right: 10px;
      transform: translateY(-50%);
      background: none;  
      border: none;
      cursor: pointer;
      font-size: 16px;
    }

    .toggle-password:hover,
  .toggle-password:focus {
    background: none;
    border: none;
    box-shadow: none;
    outline: none;
  }

  .modal, .crm-modal {
  display: none;
}

  </style>
</head>
<body>
  <header>
    <h1>Welcome to Leads Tracker</h1>
  </header>

  <main>
    <p class="tagline">Manage your leads, properties & follow-ups with ease.</p>

    <form id="loginForm">
      <input type="text" id="username" placeholder="Email" required />

      <div class="password-wrapper">
        <input type="password" id="password" placeholder="Password" required />
        <button type="button" class="toggle-password" onclick="togglePassword()">üëÅÔ∏è</button>
      </div>

      <button type="submit">Login</button>

      <div class="forgot-password">
        <a href="pages/forgot-password.html">Forgot Password?</a>
      </div>
    </form>
  </main>

  <!-- Custom customAlert Box -->
  <div id="customAlert" class="custom-customAlert hidden">
    <div class="custom-customAlert-box">
      <p id="customAlertMessage"></p>
      <button class="btn" onclick="closecustomAlert()">OK</button>
    </div>
  </div>

    <footer class="crm-footer">
    <div><strong>LeadsTracker</strong> ¬© 2025 Smartprocare</div>
    <div>
      <a onclick="openModal('helpModal')">Help & Support</a> |
      <a onclick="openModal('crmcontactModal')">Contact Us</a> |
      <a onclick="openModal('privacyModal')">Privacy Policy</a> |
      <a href="about-us.html" target="_blank">About Us</a> |
      v1.0.4
    </div>
  </footer>

  <!-- Help Modal -->
  <div id="helpModal" class="modal">
    <div class="crm-modal-content">
      <span class="close" onclick="closeModal('helpModal')">&times;</span>
      <h2>Help & Support</h2>
      <p>
        For any issues, contact us at <a href="mailto:support@smartprocare.com">support@smartprocare.com</a><br />
        WhatsApp: <strong>+91-9467820173</strong>
      </p>
      <p><strong>Version:</strong> v1.0.4</p>
    </div>
  </div>

  <!-- Contact Modal -->
  <div id="crmcontactModal" class="crm-modal">
    <div class="crm-modal-content">
      <span class="close" onclick="closeModal('crmcontactModal')">&times;</span>
      <h2>Contact Us</h2>
      <form onsubmit="submitContactForm(event)">
        <input type="text" name="name" placeholder="Your Name" required />
        <input type="email" name="email" placeholder="Your Email" required />
        <textarea name="message" placeholder="Your Message" required></textarea>
        <button type="submit">Submit</button>
      </form>
      <p id="thankYouMsg" style="color: green; display: none; margin-top: 10px;">Thank you for reaching us. We will contact you soon!</p>
    </div>
  </div>

  <!-- Privacy Modal -->
  <div id="privacyModal" class="crm-modal">
    <div class="crm-modal-content">
      <span class="close" onclick="closeModal('privacyModal')">&times;</span>
      <h2>Privacy Policy</h2>
      <p>We respect your privacy and are committed to protecting your personal data. Your information will only be used for CRM purposes and will never be shared with third parties.</p>
      <p>By using our CRM, you agree to the collection and use of information in accordance with this policy.</p>
    </div>
  </div>



  <!-- JS -->

    <script src="assets/js/app.js"></script>

  <script>



      function openModal(id) {
  const modal = document.getElementById(id);
  if (modal) modal.style.display = 'block';
}

function closeModal(id) {
  const modal = document.getElementById(id);
  if (modal) modal.style.display = 'none';
}

// Updated to reflect correct modal IDs
window.onclick = function(event) {
  ['helpModal', 'crmcontactModal', 'privacyModal'].forEach(id => {
    const modal = document.getElementById(id);
    if (event.target === modal) closeModal(id);
  });
};

function submitContactForm(event) {
  event.preventDefault();
  document.getElementById('thankYouMsg').style.display = 'block';
  setTimeout(() => closeModal('crmcontactModal'), 2500); // Fixed ID
}

    function togglePassword() {
      const passwordInput = document.getElementById("password");
      const toggleBtn = event.target;

      if (passwordInput.type === "password") {
        passwordInput.type = "text";
        toggleBtn.textContent = "üôà";
      } else {
        passwordInput.type = "password";
        toggleBtn.textContent = "üëÅÔ∏è";
      }
    }

    function closecustomAlert() {
      document.getElementById("customAlert").classList.add("hidden");
    }


    
async function checkAppVersion() {
    try {
      const res = await fetch('/version.json', { cache: 'no-store' });
      const { version } = await res.json();
      const currentVersion = localStorage.getItem('appVersion');

      if (currentVersion && currentVersion !== version) {
        console.log('New version found. Clearing cache and cookie...');
        
        // üî¥ Clear local/session storage
        localStorage.clear();
        sessionStorage.clear();

        // üî¥ Delete all cookies (including JWT)
        document.cookie.split(";").forEach(function (c) {
          document.cookie = c
            .replace(/^ +/, "")
            .replace(/=.*/, "=;expires=" + new Date().toUTCString() + ";path=/");
        });

        // üîÅ Update version and force reload
        localStorage.setItem('appVersion', version);
        location.reload(true);
      } else {
        localStorage.setItem('appVersion', version);
      }

    } catch (e) {
      console.error('Version check failed', e);
    }
  }

  // ‚úÖ Call this on page load
  checkAppVersion();



   
  </script>

</body>
</html>
